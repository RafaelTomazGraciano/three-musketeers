#include <stdio.tm>
#include <stdlib.tm>

int main() {
    int *p1;
    int *p2;
    int *p3;
    int *arr1;
    int *arr2;
    int i;
    
    printf("Testing multiple malloc allocations:\n\n");
    
    // Allocate multiple single integers
    p1 = malloc(1);
    p2 = malloc(1);
    p3 = malloc(1);
    
    (*p1) = 10;
    (*p2) = 20;
    (*p3) = 30;
    
    printf("Single allocations:\n");
    printf("p1 = %d, p2 = %d, p3 = %d\n", (*p1), (*p2), (*p3));
    printf("Sum = %d\n", (*p1) + (*p2) + (*p3));
    
    // Allocate multiple arrays
    arr1 = malloc(3);
    arr2 = malloc(3);
    
    for (i = 0; i < 3; i = i + 1) {
        arr1[i] = i * 10;
        arr2[i] = i * 100;
    }
    
    printf("\nArray 1:\n");
    for (i = 0; i < 3; i = i + 1) {
        printf("arr1[%d] = %d\n", i, arr1[i]);
    }
    
    printf("\nArray 2:\n");
    for (i = 0; i < 3; i = i + 1) {
        printf("arr2[%d] = %d\n", i, arr2[i]);
    }
    
    // Modify values
    (*p1) = (*p1) + (*p2);
    arr1[1] = arr1[1] + arr2[1];
    
    printf("\nAfter modifications:\n");
    printf("p1 = %d\n", (*p1));
    printf("arr1[1] = %d\n", arr1[1]);
    
    // Free in different order
    free(p2);
    free(arr1);
    free(p1);
    free(arr2);
    free(p3);
    
    printf("\nAll memory freed\n");
    
    // Reallocate after freeing
    p1 = malloc(1);
    (*p1) = 999;
    printf("\nReallocated p1 = %d\n", (*p1));
    free(p1);
    
    return 0;
}