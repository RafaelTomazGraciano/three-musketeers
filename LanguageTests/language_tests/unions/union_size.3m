#include <stdio.tm>

union Small {
    char c,
    int i
};

union Large {
    int i,
    double d
};

union Mixed {
    char c,
    int i,
    double d
};

int main() {
    union Small s;
    union Large l;
    union Mixed m;
    
    printf("=== Union Size Test ===\n\n");
    
    printf("Union sizes (should be size of largest member):\n");
    printf("  Small union (char, int): stores int\n");
    printf("  Large union (int, double): stores double\n");
    printf("  Mixed union (char, int, double): stores double\n\n");
    
    // Test that all members share same memory
    printf("Memory sharing test:\n");
    
    s.i = 65;  // ASCII 'A' in least significant byte
    printf("Small union:\n");
    printf("  Set s.i = 65\n");
    printf("  s.i = %d\n", s.i);
    printf("  s.c = %c (shares memory with s.i)\n", s.c);
    
    printf("\n");
    
    l.i = 1078523331;  // Bit pattern that looks like ~3.14 as double
    printf("Large union:\n");
    printf("  Set l.i = 1078523331\n");
    printf("  l.i = %d\n", l.i);
    printf("  l.d = %f (shares memory, different interpretation)\n", l.d);
    
    printf("\n");
    
    m.d = 0.0;
    m.i = 255;
    printf("Mixed union:\n");
    printf("  Set m.d = 0.0, then m.i = 255\n");
    printf("  m.i = %d\n", m.i);
    printf("  m.c = %c\n", m.c);
    printf("  m.d = %f (corrupted by integer write)\n", m.d);
    
    return 0;
}